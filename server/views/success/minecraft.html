<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1>Minecraft</h1>
            <p>You can manage here the minecraft server</p>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card mb-3">
                <div class="card-header">
                    <i class="fa fa-user-circle"></i> Status
                </div>
                <div class="card-body">
                    <p>Current status : <b id="currentStatusMinecraftServer">...</b></p>
                    <button id="startMinecraftServerButton" class="btn btn-primary">Start</button>
                    <button id="stopMinecraftServerButton" class="btn btn-primary">Stop</button>
                </div>
                <div class="card-footer small text-muted">Check Current Status of the server</div>
            </div>
        </div>
    </div>
    <script>
        $(() => {
            let token = Cookies.get("cookie_monster_rpz");
            let socket = io('/minecraft');
            socket.on('connect', () => {
                console.log("socket connected");
            });
            socket.emit('authenticate', {
                token: token
            });

            socket.on('stdin', data => console.log(data));

            socket.on('stderr', data => console.err(data));


            $('#startMinecraftServerButton').click(event => {
                socket.emit('start');

                // $.ajax({
                //     url:'/api/game_server/minecraft/start',
                //     type: 'POST',
                //     noprint:true
                // })
                //     .then(ret => {
                //         console.log(ret);
                //     })
            });

            $('#stopMinecraftServerButton').click(event => {
               socket.emit('stop');
            });

            $.ajax({
                url:'/api/game_server/minecraft',
                type: 'GET',
                noprint: true
            })
                .then((inUse) => {
                    if(inUse) {
                        $('#currentStatusMinecraftServer').text("Running");
                    } else {
                        $('#currentStatusMinecraftServer').text("Off")
                    }
                })
        });
    </script>
</div>